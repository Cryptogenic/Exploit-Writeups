## Two Truths and a Fib (Misc, 100pts)

#### Challenge Description

Can you catch the fibber? Author: Trashcanna

nc umbccd.io 6000



#### Overview

When connecting to the given credentials, we're prompted with the following:

```
$ nc umbccd.io 6000
Welcome to two truths and a fib! You'll be given three numbers:
one of them will be a fibonacci number and two of them will not.
It's your job to tell which is which and send back the fibonacci.
Example:
12, 8, 4
Which number is a fib?
>> 8
Correct!


[71268326980317, 17231358458698, 7778742049]
>>
Oof, too slow!
```

We simply have to take the three numbers given to us, check each one to see if it's a fibonacci number, and give that number back. But we have to do it fast, if we take more than a second, the connection is terminated. Scripting comes to the rescue.



#### Solution

Interestingly, I initially wrote a script that utilized pwntools for communication with the server. Within 10 questions it would fail citing a parsing bug on the python script running on the CTF server.

```
>> Traceback (most recent call last):
  File "/home/challuser/twotruthsfib.py", line 76, in <module>
    solution = int(solution)
    
ValueError: invalid literal for int() with base 10: ''
```

I'm assuming this is because something in the pwntools pipeline was too slow and our connection got terminated or something, but I didn't investigate further. Instead, I just wrote a new script using raw sockets.

```python
import socket
import math
 
# A utility function that returns true if x is perfect square
def isPerfectSquare(x):
    s = int(math.sqrt(x))
    return s*s == x
 
# Returns true if n is a Fibinacci Number, else false
def isFibonacci(n):
    # n is Fibinacci if one of 5*n*n + 4 or 5*n*n - 4 or both
    # is a perferct square
    return isPerfectSquare(5*n*n + 4) or isPerfectSquare(5*n*n - 4)
 
ip='umbccd.io'
port=6000
 
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((ip, port))
 
def find_between(s, start, end):
    return (s.split(start))[1].split(end)[0]
 
while True:
    data = s.recv(1024).decode("utf-8")
    print(data)
 
    if "[" in data and "," in data:
        options = find_between(data, "[", "]")
        optionList = options.split(", ")
 
        fibber = "0"
 
        for option in optionList:
            if(isFibonacci(int(option))):
                fibber = option
 
        fibber += "\n"
        s.send(str.encode(fibber))
```

After 100 successful answers, the server will give us the flag: 

```
Congrats! Here's your flag: DawgCTF{jU$T_l1k3_w3lc0me_w33k}
```



#### Flag

```
DawgCTF{jU$T_l1k3_w3lc0me_w33k}
```

